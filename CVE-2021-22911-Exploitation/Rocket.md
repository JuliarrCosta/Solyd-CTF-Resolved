
# CTF - Rocket.chat (CVE-2021-22911)  

> This repository documents the exploration of CVE-2021-22911 in a controlled environment provided by Solyd Offensive Security. 

Obs:. This was performed in a controlled environment. Don't use these techniques on system without permission. 
## Risk Summary

| Vulnerability                        | Severity | Status     | Service     |
| ------------------------------------ | -------- | ---------- | ----------- |
| CVE-2021-22911 (Hijacking, PE, RECE) | Critical | Reproduced | Rocket.chat |

## Technical Summary 
### Process Followed
- Information Gathering
- Enumeration
- Vulnerability Analysis 
- Exploitation 
- Reporting 
### Scope of Testing 
- Application: Rocket Chat - Noogle.sy
### Testing Methodology
- OWASP Web Security Testing Guide
### List of vulnerabilities 
- CVE-2021-22911
	- Reference: https://github.com/CsEnox/CVE-2021-22911
- Security Misconfiguration 
	- Leaked emails
	- SSH key exposed 
	- Insecure file permissions -> backup.sh 
- Broken Access Control 
	- Backup.sh

### Tools
	- Nmap
	- Exploit CsEnox
	- Linux terminal
		`rm -rf /tmp/rootbash
		`cp /bin/bash /tmp/rootbash
		`chmod +xs /tmp/rootbash 
## Poc
#### Enumeration
- `nmap -sS -sV [host]		
#### Initial reconnaissance 
> ![[CTF-Rocket-1.png]]

![[CTF-Rocket-2.png]]

#### Exploit
![[CTF-Rocket-3.png]]

#### SSH key exposed
![[CTF-Rocket-4.png]]
![[CTF-Rocket-5.png]]
#### Exploitation 

![[CTF-Rocket-6.png]]
![[CTF-Rocket-7.png]]
![[CTF-Rocket-8.png]]
